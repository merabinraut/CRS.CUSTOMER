@using Newtonsoft.Json

@functions {
    public dynamic ReadJson()
    {
        string filePath = HttpContext.Current.Server.MapPath("~/App_Data/RedirectURLConfiguration.json");
        string jsonContent = System.IO.File.ReadAllText(filePath);
        var jsonData = JsonConvert.DeserializeObject<dynamic>(jsonContent);
        return jsonData;
    }
}
@{
    var jsonData = ReadJson();
}

@model CRS.CUSTOMER.APPLICATION.Models.Home.RegistrationModel
@{
    ViewBag.Title = "パスワードの再設定‖ホスログ《 ホストクラブ初回来店・ネット予約 》";
    Layout = null;
}
<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/Content/assets/css/tailwind.css">
    <link rel="stylesheet" href="/Content/assets/css/customer/global_v1.css">
    <link rel="stylesheet" href="/Content/assets/css/customer/club.css">
    <link rel="stylesheet" href="/Content/assets/css/customer/customcss.css">
    <link rel="stylesheet" href="/Content/assets/css/owl-carousel/owl.carousel.min.css">
    <link rel="stylesheet" href="/Content/assets/css/owl-carousel/owl.theme.default.min.css">
    <link rel="stylesheet" href="/Content/assets/css/customer/responsive.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.8.1/flowbite.min.css" rel="stylesheet" />
    <script src="/Content/assets/js/owl.carousel.js"></script>
    <script src="/Content/assets/js/modal.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tw-elements/dist/css/tw-elements.min.css" />
    <link rel="stylesheet"
          href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css">
    <link rel="stylesheet"
          href="https://maxst.icons8.com/vue-static/landings/line-awesome/font-awesome-line-awesome/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/select2-bootstrap-css/1.4.6/select2-bootstrap.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.4/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.4/js/select2.min.js"></script>
    <script src="/Content/js/NotificationMessageToaster.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <title>@ViewBag.Title</title>
</head>
<body class="md:hidden">

    <style>
        .customContainer {
            padding: 0 24px;
        }

        .identification {
            color: #18181B;
            font-size: 16px;
            font-style: normal;
            font-weight: 700;
            line-height: 16px;
            margin-top: 12px;
            /* 100% */
        }

        input {
            background: none;
            outline: none;
        }

            input:focus {
                background: none;
                outline: none;
            }

        .displayMessage {
            margin-top: 16px;
            color: var(--Secondary-Text-II, #A1A1AA);
            font-feature-settings: 'clig' off, 'liga' off;
            font-size: 10px;
            font-style: normal;
            font-weight: 500;
            line-height: 16px;
            /* 160% */
        }

        .remainigTime {
            color: #B12D23;
            text-align: right;
            font-feature-settings: 'clig' off, 'liga' off;
            font-size: 12px;
            font-style: normal;
            font-weight: 500;
            line-height: 16px;
            /* 160% */
        }

        .otpContainer {
            margin-top: 16px;
            margin-bottom: 24px;
            border: 1px solid #ECECEC;
            border-radius: 4px;
        }

            .otpContainer > input {
                border: none;
            }

                .otpContainer > input ::placeholder {
                    color: #A6A6A6;
                    font-size: 12px;
                    font-style: normal;
                    font-weight: 400;
                    line-height: 18px;
                }

        .returnButton {
            border-radius: 4px;
            border: 1px solid #F1F1F1;
            color: #5F5F5F;
            font-feature-settings: 'clig' off, 'liga' off;
            font-size: 14px;
            font-style: normal;
            font-weight: 600;
            line-height: 18px;
            display: flex;
            padding: 10px;
            justify-content: center;
            align-items: center;
            gap: 10px;
            flex: 1 0 0;
        }

        .nextButton {
            display: flex;
            padding: 10px;
            justify-content: center;
            align-items: center;
            gap: 10px;
            flex: 1 0 0;
            border-radius: 4px;
            background: #D75A8B;
            color: #FFF;
            font-size: 14px;
            font-style: normal;
            font-weight: 600;
            line-height: 18px;
        }

        .acessCodeWrapper {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 8px;
        }

        .accessCodeText {
            color: #18181B;
            font-size: 12px;
            font-style: normal;
            font-weight: 500;
            line-height: 16px;
            /* 133.333% */
            letter-spacing: 0.4px;
        }

        .accessCodeLink {
            color: #839AD6;
            font-feature-settings: 'clig' off, 'liga' off;
            font-size: 12px;
            font-style: normal;
            font-weight: 600;
            line-height: 16px;
            letter-spacing: 0.4px;
            text-decoration-line: underline;
        }

        .activated {
            display: flex;
        }

        .waitingMessage {
            color: #000;
            font-feature-settings: 'clig' off, 'liga' off;
            font-size: 10px;
            font-style: normal;
            font-weight: 500;
            line-height: normal;
        }

        .waitingMessageWrapper {
            border-radius: 4px;
            background: #FFEDED;
            margin-top: 16px;
            /*display: none;*/
        }

        .inputContainer {
            background: none;
        }


        @@media(min-width: 1005px) {
            #leftfix {
                top: 10%;
                max-width: 300px;
            }

            #innerfixed {
                top: 10%;
                max-width: 300px;
            }

            .image-container {
                display: flex;
                justify-content: center;
                align-items: center;
                overflow: hidden;
            }

                .image-container img {
                    max-width: 100%;
                    height: auto;
                    object-fit: contain;
                }

            .imgclasssecond {
                width: 300px !important;
                height: 76px !important;
            }

            .imgclassfirst {
                width: 300px !important;
                height: 152px !important;
            }
        }

        @@media(min-width: 640px) and (max-width: 730px) {

            #innerfixed {
                top: 24% !important;
                max-width: 126px !important;
            }

            .image-container {
                display: flex;
                justify-content: center;
                align-items: center;
                overflow: hidden;
            }

                .image-container img {
                    max-width: 100%;
                    height: auto;
                    object-fit: contain;
                }

            .imgclasssecond {
                width: 126px !important;
                height: 35px !important;
            }

            .imgclassfirst {
                width: 126px !important;
                height: 63px !important;
            }
        }


        @@media(min-width: 731px) and (max-width: 800px) {

            #innerfixed {
                top: 24% !important;
                max-width: 158px !important;
            }

            .image-container {
                display: flex;
                justify-content: center;
                align-items: center;
                overflow: hidden;
            }

                .image-container img {
                    max-width: 100%;
                    height: auto;
                    object-fit: contain;
                }

            .imgclasssecond {
                width: 158px !important;
                height: 76px !important;
            }

            .imgclassfirst {
                width: 158px !important;
                height: 100px !important;
            }
        }

        @@media(min-width: 801px) and (max-width: 900px) {

            #innerfixed {
                top: 15% !important;
                max-width: 191px !important;
            }

            .image-container {
                display: flex;
                justify-content: center;
                align-items: center;
                overflow: hidden;
            }

                .image-container img {
                    max-width: 100%;
                    height: auto;
                    object-fit: contain;
                }

            .imgclasssecond {
                width: 191px !important;
                height: 76px !important;
            }

            .imgclassfirst {
                width: 191px !important;
                height: 100px !important;
            }
        }

        @@media(min-width: 901px) and (max-width: 970px) {

            #innerfixed {
                top: 9% !important;
                max-width: 252px !important;
            }

            .image-container {
                display: flex;
                justify-content: center;
                align-items: center;
                overflow: hidden;
            }

                .image-container img {
                    max-width: 100%;
                    height: auto;
                    object-fit: contain;
                }

            .imgclasssecond {
                width: 252px !important;
                height: 76px !important;
            }

            .imgclassfirst {
                width: 252px !important;
                height: 152px !important;
            }
        }

        @@media(min-width: 918px) and (max-width: 1004px) {

            #innerfixed {
                top: 9% !important;
                max-width: 230px !important;
            }

            .image-container {
                display: flex;
                justify-content: center;
                align-items: center;
                overflow: hidden;
            }

                .image-container img {
                    max-width: 100%;
                    height: auto;
                    object-fit: contain;
                }

            .imgclasssecond {
                width: 300px !important;
                height: 76px !important;
            }

            .imgclassfirst {
                width: 300px !important;
                height: 152px !important;
            }
        }
    </style>
    <style>
        .modal-content {
            max-width: 100%;
            width: 400px;
        }

        .save_modal-content {
            background: #fff;
            max-width: 100%;
            width: 312px;
            padding-top: 32px;
            padding-bottom: 32px;
        }

        .modal_header {
            color: var(--1_Darker_Primary, #D17979);
            text-align: center;
            font-size: 14px;
            font-style: normal;
            font-weight: 700;
            line-height: 100%; /* 14px */
        }

        .save_cont {
            margin-top: 18px;
        }

        .savebtn {
            color: #FFF;
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            padding-top: 14px;
            padding-bottom: 14px;
            padding-right: 32px;
            padding-left: 32px;
            gap: 12px;
            border-radius: 4px;
            background: var(--Darker_Primary, #D75A8B);
        }

        input:focus {
            border: 1px solid #d75a8b !important;
        }

        input:focus-visible {
            border: 1px solid #d75a8b !important;
            outline: none
        }

        ul.delete-confirm {
            list-style-type: circle;
            width: 80%;
            margin: 14px auto;
            color: #292F33;
        }

        ul li {
            text-align: start;
            gap: 5px;
            margin-bottom: 5px;
            padding-left: 12px;
            color: #292F33;
        }

        li::marker {
            content: "\25CF";
            color: #292F33;
            font-size: 0.5em;
        }

        .disabled-div {
            opacity: 0.5;
            pointer-events: none;
            background: #F0F0F0;
            color: #BEBEBE;
        }

        .savebtndivcss {
            cursor: not-allowed;
            pointer-events: none;
        }
        /* custom select*/
        .custom-select {
            position: relative;
            display: inline-block;
        }

        select {
            appearance: none;
            padding-right: 30px; /* Space for the custom arrow */
        }

        .custom-arrow {
            position: absolute;
            right: 13px; /* Adjust this to move the icon horizontally */
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none; /* Ensures the arrow does not block clicks */
        }

        .profileimg2 {
            width: 100%;
            height: 100%;
        }

        .editoption2 {
            margin-left: 44px;
            /* margin-top: 44px; */
            height: 24px;
            width: 24px;
            border-radius: 55px;
            justify-items: center;
            position: absolute;
            background-color: #fff;
            top: 41px;
            border: 1px solid #e8e8e8;
            z-index: 0;
        }
    </style>
    <div id="test">
        <div id="leftcontent" style="margin-top: 30%; " class="flex  flex-col items-center ">
            <div id="leftfix" class="fixed">
                <a href="/" class="flex flex-row justify-center">
                    <img src="~/content/assets/images/bglogo.png" />
                </a>
                <div id="siteurl" class="flex flex-row justify-center">
                    <p style="font-size: 25px; font-weight: 600; margin-bottom: 26px" class="text-black">https://hoslog.jp/  </p>
                </div>

                <a href="@jsonData.CustomerRegistration.url" style="max-width: 300px; height: 57px; background-color: #D75A8B; border-radius: 2px; cursor: pointer; " class="flex flex-row justify-center items-center text-center">
                    <div>
                        <p style="font-size:18px;font-weight:600 ; " class="text-white">@jsonData.CustomerRegistration.text</p>
                    </div>
                </a>
                <a href="@jsonData.ClubRegistration.url" target="_blank" style="max-width: 300px; height: 57px; border-radius: 2px; box-shadow: 0px 0px 12px 0px rgba(30, 34, 75, 0.15); cursor: pointer; " class="flex flex-row justify-center items-center bg-white mt-3">
                    <div>
                        <p style="font-size:18px;font-weight:600" class="text-black">@jsonData.ClubRegistration.text</p>
                    </div>
                </a>
                <a href="@jsonData.AffiliateRegistration.url" target="_blank" style="max-width: 300px; height: 57px; border-radius: 2px; box-shadow: 0px 0px 12px 0px rgba(30, 34, 75, 0.15); cursor:pointer; " class="flex flex-row justify-center items-center bg-white mt-3">
                    <div>
                        <p style="font-size:18px;font-weight:600" class="text-black">@jsonData.AffiliateRegistration.text</p>
                    </div>
                </a>


                @*<a href="https://hoslog.jp/user/register" style="max-width: 300px; height: 57px; background-color: #D75A8B; border-radius: 2px; cursor: pointer; " class="flex flex-row justify-center items-center text-center">
            <div>
                <p style="font-size:18px;font-weight:600 ; " class="text-white">新規会員登録</p>
            </div>
        </a>
        <a href="https://owner.hoslog.jp/owner/register/" target="_blank" style="max-width: 300px; height: 57px; border-radius: 2px; box-shadow: 0px 0px 12px 0px rgba(30, 34, 75, 0.15); cursor: pointer; " class="flex flex-row justify-center items-center bg-white mt-3">
            <div>
                <p style="font-size:18px;font-weight:600" class="text-black">店舗オーナー登録</p>
            </div>
        </a>
        <a href="https://affiliate.hoslog.jp/auth/register" target="_blank" style="max-width: 300px; height: 57px; border-radius: 2px; box-shadow: 0px 0px 12px 0px rgba(30, 34, 75, 0.15); cursor:pointer; " class="flex flex-row justify-center items-center bg-white mt-3">
            <div>
                <p style="font-size:18px;font-weight:600" class="text-black">アフィリエイター登録</p>
            </div>
        </a>*@
            </div>



        </div>

        <div id="innersec">

            <div id="myform">
                <!-- for back button -->
                <div class="flex items-center  border-b border-b-[#E8E8E8] sticky top-0 bg-white z-[10] relative px-4 py-[10px] h-[44px]" id="backbutton_id">
                    <div class="flex gap-2 cursor-pointer items-center absolute top-[12px] text-sm">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22" fill="none">
                            <path d="M15.2347 2.74084C14.7855 2.29167 14.0614 2.29167 13.6122 2.74084L5.99469 10.3583C5.63719 10.7158 5.63719 11.2933 5.99469 11.6508L13.6122 19.2683C14.0614 19.7175 14.7855 19.7175 15.2347 19.2683C15.6839 18.8192 15.6839 18.095 15.2347 17.6458L8.59802 11L15.2439 4.35417C15.6839 3.91417 15.6839 3.18084 15.2347 2.74084Z"
                                  fill="#BCB08A" />
                        </svg>戻る
                    </div>
                    <div class="text-center w-full font-bold"></div>
                </div>
                <!-- back button end -->
                <div class=" px-6">
                    <!-- for request for identification -->
                    <div class="identification">
                        ご本人確認のお願い
                    </div>
                    <!-- for message -->
                    <div class="displayMessage">

                    </div>
                    <input type="hidden" name="exptime" id="exptime" value='@Html.Raw(Session["exptime"]!=null?Session["exptime"].ToString():"")' />
                    <div class="flex justify-end items-end remainigTime">
                        <span>
                            有効期限 :
                        </span>

                        <div class="flex justify-end items-end remainigTime" id="otp-code-timer">

                            @*1 分 59 秒*@
                        </div>
                    </div>
                    <!-- for waiting message -->
                    <div id="waitingMessageWrapper">
                        <div class="flex p-2 gap-2 items-center waitingMessageWrapper">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <path d="M8 1.5C4.416 1.5 1.5 4.416 1.5 8C1.5 11.584 4.416 14.5 8 14.5C11.584 14.5 14.5 11.584 14.5 8C14.5 4.416 11.584 1.5 8 1.5ZM8 2.5C8.72252 2.49912 9.43811 2.64079 10.1058 2.91688C10.7735 3.19297 11.3801 3.59806 11.891 4.10896C12.4019 4.61985 12.807 5.22652 13.0831 5.8942C13.3592 6.56189 13.5009 7.27748 13.5 8C13.5009 8.72252 13.3592 9.43811 13.0831 10.1058C12.807 10.7735 12.4019 11.3801 11.891 11.891C11.3801 12.4019 10.7735 12.807 10.1058 13.0831C9.43811 13.3592 8.72252 13.5009 8 13.5C7.27748 13.5009 6.56189 13.3592 5.8942 13.0831C5.22652 12.807 4.61985 12.4019 4.10896 11.891C3.59806 11.3801 3.19297 10.7735 2.91688 10.1058C2.64079 9.43811 2.49912 8.72252 2.5 8C2.49912 7.27748 2.64079 6.56189 2.91688 5.8942C3.19297 5.22652 3.59806 4.61985 4.10896 4.10896C4.61985 3.59806 5.22652 3.19297 5.8942 2.91688C6.56189 2.64079 7.27748 2.49912 8 2.5ZM7.5 5V6H8.5V5H7.5ZM7.5 7V11H8.5V7H7.5Z"
                                      fill="black" />
                            </svg>
                            <p class="waitingMessage">
                                10分まで、認証コードを再送信できません。
                            </p>
                        </div>
                    </div>
                    @using (Html.BeginForm("VerifyforgotpasswordOTP", "Home", FormMethod.Post, new { @role = "form", @id = "formSubmit" }))
                    {
                        @Html.AntiForgeryToken()
                        @Html.HiddenFor(model => model.AgentId)
                        @Html.HiddenFor(model => model.MobileNumber)
                        @Html.HiddenFor(model => model.NickName)
                        @Html.HiddenFor(model => model.ProcessId)
                        <!-- for otp container -->
                        <div class="otpContainer ring-0 focus:ring-0 focus:ring-transparent">
                            <input type="number" placeholder="認証コード" class="inputContainer w-full ring-0 focus:ring-0 focus:ring-transparent" name="OTPCode" oninput="limitInputLength(this, 6)" maxlength="6" required>
                        </div>
                        <!-- for button group -->
                        <div class="flex justify-between items-center gap-4 mb-4">
                            @*  <button class="returnButton" onclick="window.location.href='/login'">戻る</button>*@
                            <button class="nextButton" type="submit" name="submit" id="valCod" value="Next">送信</button>
                        </div>
                    }
                    <!-- for unable to get code  -->
                    <div class="acessCodeWrapper">
                        <div class="accessCodeText">
                            認証コードを取得できませんでしたか？
                        </div>
                        <div class="accessCodeLink" id="resend-verification-code">
                            <p class="accessCodeLink">
                                新しいコードをリクエストする
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--<div id="rightcontent" style="margin-top: 10%; " class="flex flex-col items-center">
        <div id="innerfixed" class="fixed   flex flex-col gap-2">-->
        @* <div >*@
        <!--<img src="../../content/assets/images/hpi1.jpeg" style="width:inherit" />-->
        @* </div>
            <div>*@
        <!--<img src="../../content/assets/images/hpi2.jpeg" style="width:inherit" />-->
        @*  </div>
            <div>*@
        <!--<img src="../../content/assets/images/hpi3.jpeg" style="width:inherit" />-->
        @*</div>
            <div>*@
        <!--<img src="../../content/assets/images/hpi4.jpeg" style="width:inherit" />-->
        @*  </div>
            <div>*@
        <!--<img src="../../content/assets/images/hpi5.jpeg" style="width:inherit" />-->
        @* </div>
            <div>*@
        <!--<img src="../../content/assets/images/hpi6.jpeg" style="width:inherit" />-->
        @*  </div>*@
        <!--</div>

        </div>-->



        <div id="rightcontent" style="margin-top: 10%; " class="flex flex-col items-center">
            <div id="innerfixed" class="fixed   flex flex-col gap-2">
                @{
                    if (Session["AdvertisementImage"] != null)
                    {
                     var advertisementimage = Session["AdvertisementImage"] as List<CRS.CUSTOMER.SHARED.CommonManagement.AdvertisementCommon>;
                        if (advertisementimage != null && advertisementimage.Count > 0)
                        {
                            var i = 0;
                            foreach (var item in advertisementimage)
                            {
                                @*<img src="@item"  style="width:300px;height:152px;"/>*@
                                if (item.status.ToUpper() == "A")
                                {
                                    if (i < 2)
                                    {
                                        <div class="image-container">
                                            <a href="@item.link" target="_blank">
                                                <img src="@item.image" class="imgclassfirst" alt="Advertisement Image" />
                                            </a>
                                            @*<img src="@item.image" class="imgclassfirst" />*@
                                        </div>
                                    }
                                    else
                                    {
                                        <div class="image-container">
                                            <a href="@item.link" target="_blank">
                                                <img src="@item.image" class="imgclasssecond" alt="Advertisement Image" />
                                            </a>
                                            @*<img src="@item.image" class="imgclasssecond" />*@
                                        </div>
                                    }
                                }
                                i++;

                            }
                        }
                    }

                }
            </div>

        </div>

    </div>
    <div id="confimation_modal" class="modal modalWrapper "
         style="display:none;">
        <div class="save_modal-content relative" style="max-width: 312px; border-radius: 15px;">
            <span class=" absolute  z-30 text-[#fff] text-[28px] cursor-pointer right-3" onclick="closeModal('confimation_modal')"
                  style="top:-49px">&times;</span>
            <div class="flex flex-col gap-1">
                <div class="modal_header">
                    このページを離れますか?
                </div>
                <div class="text-[12px] flex justify-center mb-2">
                    行った操作が保存されない可能性があります。
                </div>
            </div>
            <div class="border"></div>
            <div class="save_cont flex gap-2 justify-center mt-4">
                <button onclick="window.location.href='/login'" type="submit" class="savebtn w-[135px]">
                    はい
                </button>
                <div onclick="closeModal('confimation_modal')" class="flex justify-center items-center underline px-8 w-[135px]">
                    いいえ
                </div>
            </div>
        </div>
    </div>
    <script src="~/Content/validation.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    <script>

        var isValid = false;
        $('#valCod').prop('disabled', true).css('opacity', '0.5');
        function limitInputLength(input, maxLength) {
            var value = input.value;
            var numericValue = value.replace(/\D/g, '');
            var trimmedValue = numericValue.substring(0, maxLength);
            // Update input value
            input.value = trimmedValue;
            if (input.value.length > 5) {
                $('#valCod').prop('disabled', false).removeAttr('style');
            }
            else
            {
                $('#valCod').prop('disabled', true).css('opacity', '0.5');
            }
        }
        function maskLastFourDigits(number)
        {
            // Check if the number is valid
            if (typeof number !== "string" || number.length < 4) {
                return "Invalid mobile number";
            }
            // Extract the last four digits
            var lastFourDigits = number.slice(-4);
            // Mask the rest of the number with asterisks
            var maskedNumber = number.slice(0, -4).replace(/\d/g, '*') + lastFourDigits;
            return maskedNumber;

        }

        //-----masked mobile number-----//
        var mobileNumber = "@Model.MobileNumber"; // Assuming Razor syntax
        if ("@Model.MobileNumber" !== "")
        {
        var message = "" + maskLastFourDigits(mobileNumber) + " 宛にSMSを送信しました、メッセージに記載された6桁の数字を確認し、入力してください";
        $(".displayMessage").text(message);
        }



        $(function () {
            var today = new Date();
            var date = today.getFullYear() + '-' + (today.getMonth() + 1) + '-' + today.getDate();
            var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
            var dateTime = date + ' ' + time;
            countdown($("#exptime").val());
            isValid = false;
            var fTime = $("#exptime").val();
            var divElement = document.getElementById("resend-verification-code");
            divElement.style.pointerEvents = "none";
            divElement.style.opacity = 0.5;
            var buttonsAndInputs = divElement.getElementsByTagName("button");
            for (var i = 0; i < buttonsAndInputs.length; i++) {
                buttonsAndInputs[i].disabled = true;
            }

        });
        function countdown(endtime) {
            /* var countDownDate = new Date(endtime).getTime();*/
            var endtime = endtime
            const dateParts = endtime.split(' ');
            const date = dateParts[0];
            const time = dateParts[1];
            const [year, month, day] = date.split(/[-\/]/);
            const [hours, minutes, seconds] = time.split(':');
            //const isoDate = new Date(Date.UTC(year, month - 1, day, hours, minutes, seconds)).toISOString();
            const isoDate = new Date(year, month - 1, day, hours, minutes, seconds).toISOString();
            const countDownDate = new Date(isoDate);
            var x = setInterval(function () {
                //var now = new Date();
                var date2 = new Date().toISOString();
                const now = new Date(date2);
                var distance = countDownDate - now;
                var days = Math.floor(distance / (1000 * 60 * 60 * 24));
                var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                var seconds = Math.floor((distance % (1000 * 60)) / 1000);
                document.getElementById("otp-code-timer").innerHTML = minutes + "分 " + seconds + "秒 ";
                if (distance < 0) {
                    isValid = true;
                    clearInterval(x);
                    var divElement = document.getElementById("resend-verification-code");
                    divElement.style.pointerEvents = "auto";
                    divElement.style.opacity = 1;
                    var buttonsAndInputs = divElement.getElementsByTagName("button");
                    for (var i = 0; i < buttonsAndInputs.length; i++) {
                        buttonsAndInputs[i].disabled = false;
                    }
                    $('#waitingMessageWrapper').hide();
                    $("#resend-div").removeClass('resend-div');
                    $("#resend-verification-code").removeClass('disable-link');
                    document.getElementById("otp-code-timer").innerHTML = "";
                    //document.getElementById("otp-code-timer").innerHTML = "あなたの認証コードは期限切れです。再送してください。";//= "Your code is expired. Please resend.";
                }
            }, 1000);
        }
    </script>
    <script>
        $('#resend-verification-code').click('click', function () {
            $('#waitingMessageWrapper').show();
            var divElement = document.getElementById("resend-verification-code");
            divElement.style.pointerEvents = "none";
            divElement.style.opacity = 0.5;
            var buttonsAndInputs = divElement.getElementsByTagName("button");
            for (var i = 0; i < buttonsAndInputs.length; i++) {
                buttonsAndInputs[i].disabled = true;
            }
            if (isValid == true) {
                $(this).addClass('disable-link');
                $("#resend-div").addClass('resend-div');
                var RequestVerificationToken = $('input[name="__RequestVerificationToken"]').val();
                var MobileNo = $('input[name="MobileNo"]').val();
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("ResendFPOTP", "Home")',
                        data: {
                            '__RequestVerificationToken': RequestVerificationToken, 'MobileNumber': '@Model.MobileNumber', 'AgentId': '@Model.AgentId'
                        },
                        success: function (result) {
                            if (result.code == "0") {
                                $("#exptime").val(result.ExpTime);
                                countdown(result.ExpTime);
                                $("#resend-div-class").hide();
                                toastr.success(result.message);
                                isValid = false;
                            }
                            else {
                                toastr.info(result.message);
                            }
                        },
                        error: function (error) {
                        }
                    })
            }
        });
    </script>
    <script>$('#waitingMessageWrapper').hide();</script>
    <script>
 //For toaster Notification
 $(function () {
 {
     @if (TempData["Notifications"] != null)
     {
         var messages = (List<CRS.CUSTOMER.SHARED.NotificationModel>)TempData["Notifications"];
         foreach (var note in messages)
         {
             <text>showNotification("@note.Message", "@note.Title", "@note.NotificationType");</text>
         }
     }
     @{
         ViewBag.Notifications = string.Empty;
     }
     }
 });
    </script>
    <script>
        $('#backbutton_id').click(function () {
            openModal('confimation_modal')
        });
    </script>
</body>
</html>
